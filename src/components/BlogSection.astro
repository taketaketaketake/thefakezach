---
import { getCollection } from "astro:content";

const posts = await getCollection("blog", ({ data }) => !data.draft);
const sortedPosts = posts.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<section id="blog" class="w-full" aria-labelledby="blog-heading">
  <h2 id="blog-heading" class="text-2xl font-bold text-white mb-6">Blog</h2>

  {sortedPosts.length === 0 ? (
    <p class="text-zinc-400">No posts yet.</p>
  ) : (
    <div class="flex flex-col gap-4">
      {sortedPosts.map((post) => (
        <a
          href={`/blog/${post.slug}`}
          class="block bg-zinc-900/50 border border-zinc-800 rounded-xl p-5 hover:border-pink-500/50 hover:bg-zinc-900 transition-all active:scale-[0.98] no-underline"
        >
          <time class="text-sm text-zinc-500" datetime={post.data.date.toISOString()}>
            {post.data.date.toLocaleDateString("en-US", {
              year: "numeric",
              month: "short",
              day: "numeric",
            })}
          </time>
          <h3 class="text-lg font-semibold text-white mt-1 mb-2">{post.data.title}</h3>
          <p class="text-zinc-400 text-base leading-relaxed">{post.data.description}</p>
        </a>
      ))}
    </div>
  )}
</section>
